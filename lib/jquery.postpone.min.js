/**
 * @fileOverview jQuery Postpone
 * Copyright (c) 2012 Aldwin "Avaq" Vlasblom, https://github.com/Avaq
 * Licensed under the MIT license (/LICENSE)
 *
 * @author Aldwin "Avaq" Vlasblom <aldwin.vlasblom@gmail.com>, https://github.com/Avaq
 * @version 1.2
 * @homepage https://github.com/Avaq/jQuery-Postpone
 */
;(function(e){function o(r){var s,o=0;if(r==undefined||r==null){return false}if(!isNaN(r)){return parseInt(r,10)}s=e.trim(r.toString()).split(n);if(!s||s.length==0){return false}for(var u=0;u<s.length;u++){var a,f,l,c=0;a=t.exec(s[u])||[];if(a[2]){f=parseInt(a[1],10);l=i[a[2]]||1;c=f*l}else if(a[1]){c=parseInt(r,10)}else{return false}o+=c}return o}function u(t,n){n=e.extend({},s,n);var r=e.Deferred(),i=r.promise(),t=e.makeArray(t),u=t.shift(),a=-1,f=-1,l=o(u),c,h=function(e,t){m=true;a=Date.now();c=(n.type==1?setInterval:setTimeout)(e,t)},p=function(){m=false;(n.type==1?clearInterval:clearTimeout)(c);c=null},d=function(e){if(f>=0){f=e}else{h(y,e)}},v=function(e,s){p();var u=o(s);if(typeof l!="number"||isNaN(l)){r.rejectWith(i,["Could not recognize '"+s+"' as a valid indication of time."]);return this}var f=this.timeRemaining()+(e?-u:+u);if(n.type==1){var c=y;n.type=3;y=function(){i.i++;a=Date.now();r.notifyWith(i,t);y=c;n.type=1;if(i.i==g){return r.resolveWith(i,t)}else{h(y,l)}}}d(f>=0?f:0);return this},m=false,g=-1,y=function(){switch(n.type){case 0:return function(){r.resolveWith(i,t)};case 1:return function(){i.i++;a=Date.now();r.notifyWith(i,t);if(i.i==g){p();return r.resolveWith(i,t)}};case 2:return function(){var e;i.i++;a=Date.now();r.notifyWith(i,t);e=Date.now();if(i.i==g){return r.resolveWith(i,t)}else if(m){h(y,l-Math.abs(e-a))}}}}();if(typeof l!="number"||isNaN(l)){r.rejectWith(i,["Could not recognise '"+u+"' as a valid indication of time."])}else{h(y,l)}e.extend(i,{i:0,clear:function(){p();r.rejectWith(i,["The timeout was cleared."]);return this},complete:function(){p();r.resolveWith(i,t);return this},times:function(e){i.i=0;g=parseInt(e,10);return this},trigger:function(){p();y.apply(i,t);d(l);return this},reset:function(){p();d(l);return this},postpone:function(e){return v.call(this,false,e)},advance:function(e){return v.call(this,true,e)},pause:function(){p();f=this.timeRemaining();return this},play:function(){if(f<0){return this}h(y,f);f=-1;return this},stop:function(){p();f=l;return this},timeRemaining:function(){return f>=0?f:l-(Date.now()-a)},isPaused:function(){return f>=0}});return i}var t=/^([0-9]+)\s*(.*)?$/,n=/(?:\s+and\s+|\s*,\s*)/,r={ms:1,cs:10,ds:100,s:1e3,das:1e4,hs:1e5,ks:1e6,m:6e4,h:36e5,d:864e5},i={millisecond:r.ms,milliseconds:r.ms,ms:r.ms,centisecond:r.cs,centiseconds:r.cs,cs:r.cs,decisecond:r.ds,deciseconds:r.ds,ds:r.ds,second:r.s,seconds:r.s,sec:r.s,secs:r.s,s:r.s,decasecond:r.das,decaseconds:r.das,das:r.das,hectasecond:r.hs,hectaseconds:r.hs,hs:r.hs,kilosecond:r.ks,kiloseconds:r.ks,kiloseconds:r.ks,minute:r.m,minutes:r.m,min:r.m,mins:r.m,m:r.m,hour:r.h,hours:r.h,h:r.h,day:r.d,days:r.d,d:r.d},s={type:0};e.extend({after:function(){return u(arguments,{type:0})},every:function(e){return u(arguments,{type:1})},recur:function(){return u(arguments,{type:2})}})})(jQuery);
